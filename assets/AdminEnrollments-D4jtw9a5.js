import{_ as y,r as d,l as _,o as b,c as n,a as t,q as v,t as r,F as k,f as E,a4 as A,i as a,a5 as C}from"./index-DuVCQ5_p.js";const S={class:"admin-page-container"},D={class:"filter-tabs"},F={key:0,class:"page-loader-container"},I={key:1,class:"error-message"},w={key:2,class:"enrollments-table-container"},T={class:"enrollments-table"},$={"data-label":"User ID",class:"user-id-cell"},x=["title"],B={"data-label":"Course Title"},L={"data-label":"Enrolled At"},N={"data-label":"Status"},P={"data-label":"Actions",class:"actions-cell"},U=["onClick"],M={key:1},V={key:3,class:"no-data-message"},q={__name:"AdminEnrollments",setup(z){const i=d([]),u=d(!0),c=d(null),o=d("all"),f=async()=>{try{u.value=!0,c.value=null,i.value=await A()}catch(s){console.error("Failed to fetch enrollments:",s),c.value=s}finally{u.value=!1}},m=_(()=>o.value==="pending"?i.value.filter(s=>s.status==="pending_verification"):i.value),p=_(()=>i.value.filter(s=>s.status==="pending_verification").length),g=async s=>{if(confirm("Are you sure you want to confirm this payment and grant access to the course?"))try{await C(s,"active"),alert("Enrollment confirmed successfully!"),f()}catch(e){console.error("Failed to confirm enrollment:",e),alert("There was an error confirming the enrollment. Please check the console.")}},h=s=>!s||!s.toDate?"N/A":s.toDate().toLocaleString("en-US",{dateStyle:"medium",timeStyle:"short"});return b(f),(s,e)=>(a(),n("div",S,[e[6]||(e[6]=t("div",{class:"page-header"},[t("h1",{class:"page-title"},"Manage Enrollments")],-1)),t("div",D,[t("button",{onClick:e[0]||(e[0]=l=>o.value="all"),class:v({active:o.value==="all"})}," All Enrollments ",2),t("button",{onClick:e[1]||(e[1]=l=>o.value="pending"),class:v({active:o.value==="pending"})}," Pending Verification ("+r(p.value)+") ",3)]),u.value?(a(),n("div",F,e[2]||(e[2]=[t("div",{class:"spinner"},null,-1)]))):c.value?(a(),n("div",I,e[3]||(e[3]=[t("p",null,"Failed to load enrollments.",-1)]))):m.value.length>0?(a(),n("div",w,[t("table",T,[e[4]||(e[4]=t("thead",null,[t("tr",null,[t("th",null,"User ID"),t("th",null,"Course Title"),t("th",null,"Enrolled At"),t("th",null,"Status"),t("th",null,"Actions")])],-1)),t("tbody",null,[(a(!0),n(k,null,E(m.value,l=>(a(),n("tr",{key:l.id},[t("td",$,[t("span",{title:l.userId},r(l.userId),9,x)]),t("td",B,r(l.courseTitle),1),t("td",L,r(h(l.enrolledAt)),1),t("td",N,[t("span",{class:v(["status-badge",`status-${l.status}`])},r(l.status),3)]),t("td",P,[l.status==="pending_verification"?(a(),n("button",{key:0,onClick:j=>g(l.id),class:"btn-action btn-confirm"}," Confirm Payment ",8,U)):(a(),n("span",M,"-"))])]))),128))])])])):(a(),n("div",V,e[5]||(e[5]=[t("p",null,"No enrollments found for the selected filter.",-1)])))]))}},H=y(q,[["__scopeId","data-v-dbe29910"]]);export{H as default};
