import{_ as T,f as v,s as S,o as D,V as E,W as A,c as i,a as t,t as g,b as F,w as I,X as B,j as f,k as r,y as n,F as V,r as L,Y as H,m as P,d as u,e as $}from"./index-IR6LO8EE.js";const G={class:"admin-page-container"},O={class:"page-header"},W={class:"page-title"},j={class:"header-actions"},K=["disabled"],X={key:0,class:"page-loader-container"},Y={key:1,class:"error-message"},q={class:"form-section"},z={class:"form-grid"},J={class:"form-group"},Q={class:"form-group"},Z={class:"form-group full-width"},ee={class:"form-group"},te={class:"form-group"},oe={class:"form-group"},le={class:"form-group"},se={class:"form-group full-width"},ae={class:"form-section"},re={class:"modules-container"},ne={class:"module-header"},ie=["onClick"],ue={class:"form-group"},de=["onUpdate:modelValue"],ce=["onUpdate:modelValue","placeholder"],pe=["onUpdate:modelValue"],ve=["onUpdate:modelValue"],me=["onClick"],ge=["onClick"],fe={__name:"CourseEditorView",setup(ye){const k=S(),M=P(),y=v(k.params.id||null),U=v(!!y.value),_=v(U.value),b=v(!1),C=v(null),o=v({title:"",slug:"",description:"",category:"",level:"",price:0,currency:"NGN",imageUrl:"",modules:[]}),w=()=>{o.value.modules.push({title:"",lessons:[]})},x=s=>{o.value.modules.splice(s,1)},R=s=>{o.value.modules[s].lessons.push({title:"",textContentHTML:"",videoURL:""})},N=(s,e)=>{o.value.modules[s].lessons.splice(e,1)},h=async()=>{b.value=!0;try{const s={title:o.value.title,slug:o.value.slug,description:o.value.description,category:o.value.category,level:o.value.level,price:o.value.price,currency:o.value.currency,imageUrl:o.value.imageUrl,moduleOrder:o.value.modules.map(l=>l.title)},e=o.value.modules.flatMap((l,c)=>l.lessons.map((a,m)=>({...a,moduleId:l.title,order:c*100+m}))),d=await H(y.value,s,e);alert("Course saved successfully!"),M.push("/admin/courses")}catch(s){console.error("Failed to save course:",s),alert("Error saving course. Please check the console for details.")}finally{b.value=!1}};return D(async()=>{if(U.value)try{const[s,e]=await Promise.all([E(y.value),A(y.value)]);if(!s){C.value="Course not found.";return}const d=new Map;e.forEach(l=>{d.has(l.moduleId)||d.set(l.moduleId,{title:l.moduleId,lessons:[]}),d.get(l.moduleId).lessons.push(l)}),o.value={...s,modules:Array.from(d.values())}}catch(s){console.error("Failed to load course for editing:",s),C.value="Failed to load course data."}finally{_.value=!1}}),(s,e)=>{const d=B("RouterLink");return u(),i("div",G,[t("div",O,[t("h1",W,g(U.value?"Edit Course":"Create New Course"),1),t("div",j,[F(d,{to:"/admin/courses",class:"btn btn-secondary"},{default:I(()=>e[8]||(e[8]=[$("Cancel",-1)])),_:1,__:[8]}),t("button",{onClick:h,class:"btn btn-primary",disabled:b.value},g(b.value?"Saving...":"Save & Publish"),9,K)])]),_.value?(u(),i("div",X,e[9]||(e[9]=[t("div",{class:"spinner"},null,-1)]))):C.value?(u(),i("div",Y,[t("p",null,g(C.value),1)])):(u(),i("form",{key:2,onSubmit:f(h,["prevent"]),class:"course-editor-form"},[t("div",q,[e[18]||(e[18]=t("h2",{class:"section-title"},"Core Details",-1)),t("div",z,[t("div",J,[e[10]||(e[10]=t("label",{for:"title"},"Course Title",-1)),r(t("input",{id:"title","onUpdate:modelValue":e[0]||(e[0]=l=>o.value.title=l),type:"text",placeholder:"e.g., AI for Content & Marketing"},null,512),[[n,o.value.title]])]),t("div",Q,[e[11]||(e[11]=t("label",{for:"slug"},"URL Slug",-1)),r(t("input",{id:"slug","onUpdate:modelValue":e[1]||(e[1]=l=>o.value.slug=l),type:"text",placeholder:"e.g., ai-content-marketing-v1"},null,512),[[n,o.value.slug]])]),t("div",Z,[e[12]||(e[12]=t("label",{for:"description"},"Short Description",-1)),r(t("textarea",{id:"description","onUpdate:modelValue":e[2]||(e[2]=l=>o.value.description=l),rows:"3",placeholder:"A short, compelling description for the course card."},null,512),[[n,o.value.description]])]),t("div",ee,[e[13]||(e[13]=t("label",{for:"category"},"Category",-1)),r(t("input",{id:"category","onUpdate:modelValue":e[3]||(e[3]=l=>o.value.category=l),type:"text",placeholder:"e.g., Content & Marketing"},null,512),[[n,o.value.category]])]),t("div",te,[e[14]||(e[14]=t("label",{for:"level"},"Level",-1)),r(t("input",{id:"level","onUpdate:modelValue":e[4]||(e[4]=l=>o.value.level=l),type:"text",placeholder:"e.g., Beginner"},null,512),[[n,o.value.level]])]),t("div",oe,[e[15]||(e[15]=t("label",{for:"price"},"Price (in Kobo/Cents)",-1)),r(t("input",{id:"price","onUpdate:modelValue":e[5]||(e[5]=l=>o.value.price=l),type:"number",placeholder:"e.g., 29900 for NGN 299.00"},null,512),[[n,o.value.price,void 0,{number:!0}]])]),t("div",le,[e[16]||(e[16]=t("label",{for:"currency"},"Currency",-1)),r(t("input",{id:"currency","onUpdate:modelValue":e[6]||(e[6]=l=>o.value.currency=l),type:"text",placeholder:"e.g., NGN"},null,512),[[n,o.value.currency]])]),t("div",se,[e[17]||(e[17]=t("label",{for:"imageUrl"},"Thumbnail Image URL",-1)),r(t("input",{id:"imageUrl","onUpdate:modelValue":e[7]||(e[7]=l=>o.value.imageUrl=l),type:"text",placeholder:"https://images.pexels.com/..."},null,512),[[n,o.value.imageUrl]])])])]),t("div",ae,[e[21]||(e[21]=t("h2",{class:"section-title"},"Curriculum",-1)),t("div",re,[(u(!0),i(V,null,L(o.value.modules,(l,c)=>(u(),i("div",{key:c,class:"module-item"},[t("div",ne,[t("h3",null,"Module "+g(c+1)+": "+g(l.title),1),t("button",{onClick:f(a=>x(c),["prevent"]),class:"btn-action btn-delete"}," Remove Module ",8,ie)]),t("div",ue,[e[19]||(e[19]=t("label",null,"Module Title",-1)),r(t("input",{"onUpdate:modelValue":a=>l.title=a,type:"text",placeholder:"e.g., Foundations of AI"},null,8,de),[[n,l.title]])]),e[20]||(e[20]=t("h4",null,"Lessons",-1)),(u(!0),i(V,null,L(l.lessons,(a,m)=>(u(),i("div",{key:m,class:"lesson-item"},[r(t("input",{"onUpdate:modelValue":p=>a.title=p,type:"text",placeholder:`Lesson ${m+1} Title`},null,8,ce),[[n,a.title]]),r(t("textarea",{"onUpdate:modelValue":p=>a.textContentHTML=p,rows:"3",placeholder:"Lesson content (can include HTML tags)"},null,8,pe),[[n,a.textContentHTML]]),r(t("input",{"onUpdate:modelValue":p=>a.videoURL=p,type:"text",placeholder:"Secure Video URL (Vimeo/Wistia)"},null,8,ve),[[n,a.videoURL]]),t("button",{onClick:f(p=>N(c,m),["prevent"]),class:"btn-action btn-delete"}," Remove Lesson ",8,me)]))),128)),t("button",{onClick:f(a=>R(c),["prevent"]),class:"btn btn-secondary"}," Add Lesson to Module ",8,ge)]))),128))]),t("button",{onClick:f(w,["prevent"]),class:"btn btn-primary"}," Add New Module ")])],32))])}}},Ce=T(fe,[["__scopeId","data-v-d36edb3f"]]);export{Ce as default};
