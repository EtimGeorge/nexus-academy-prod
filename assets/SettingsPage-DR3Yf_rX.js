import{_ as S,l as x,f as n,J as P,g as D,c as a,a as e,i as w,j as V,k as l,y as u,t as C,v as M,e as U,N as h,O as q,P as B,m as G,d,Q as I}from"./index-IR6LO8EE.js";const L={class:"settings-page-content"},R={class:"settings-card"},z={class:"form-group"},F={class:"form-row"},Y={class:"form-group"},$={class:"form-group"},j={class:"form-actions"},J=["disabled"],O={key:1},Q={class:"settings-card"},Z={class:"form-group"},_={class:"settings-card danger-zone"},H={class:"danger-zone-row"},K={key:0,class:"modal-overlay"},W={class:"modal-content"},X={class:"form-group"},ee={key:0},se={key:1,class:"form-group"},te={class:"modal-actions"},oe=["disabled"],re={__name:"SettingsPage",setup(ne){const f=x.currentUser,k=G(),y=n(f?.providerData[0]?.providerId==="password"),p=n(!1),c=n(!1),i=n(!1),v=n(""),m=n(""),t=P({current:"",new:"",confirm:""}),g=P({currency:"NGN"}),b=D(()=>y.value&&i.value),N=D(()=>v.value==="DELETE"),T=async()=>{if(t.new!==t.confirm){alert("New passwords do not match.");return}p.value=!0;try{await h(t.current),await I(t.new),alert("Password updated successfully!"),t.current="",t.new="",t.confirm=""}catch(r){console.error("Password change failed:",r),alert(r.code==="auth/wrong-password"?"The current password you entered is incorrect.":"Failed to update password.")}finally{p.value=!1}},A=()=>{alert("Redirecting to our secure payment portal...")},E=async()=>{c.value=!0;try{await h(m.value),await q(f.uid),await B(),alert("Your account has been successfully deleted."),k.push("/login")}catch(r){console.error("Account deletion failed:",r),alert(r.code==="auth/wrong-password"?"Incorrect password. Account deletion cancelled.":"An error occurred during re-authentication.")}finally{c.value=!1,i.value=!1}};return(r,s)=>(d(),a("div",L,[s[25]||(s[25]=e("header",{class:"settings-header"},[e("h1",null,"Account Settings"),e("p",null,"Manage your account security, payment methods, and preferences.")],-1)),e("div",R,[s[11]||(s[11]=e("h2",null,"Security",-1)),y.value?(d(),a("form",{key:0,onSubmit:V(T,["prevent"])},[e("div",z,[s[8]||(s[8]=e("label",{for:"current-password"},"Current Password",-1)),l(e("input",{type:"password","onUpdate:modelValue":s[0]||(s[0]=o=>t.current=o),required:""},null,512),[[u,t.current]])]),e("div",F,[e("div",Y,[s[9]||(s[9]=e("label",{for:"new-password"},"New Password",-1)),l(e("input",{type:"password","onUpdate:modelValue":s[1]||(s[1]=o=>t.new=o),required:""},null,512),[[u,t.new]])]),e("div",$,[s[10]||(s[10]=e("label",{for:"confirm-password"},"Confirm New Password",-1)),l(e("input",{type:"password","onUpdate:modelValue":s[2]||(s[2]=o=>t.confirm=o),required:""},null,512),[[u,t.confirm]])])]),e("div",j,[e("button",{type:"submit",class:"btn btn-primary",disabled:p.value},C(p.value?"Updating...":"Update Password"),9,J)])],32)):(d(),a("p",O," Password management is not available for accounts created with a social provider (e.g., Google). "))]),e("div",{class:"settings-card"},[s[13]||(s[13]=e("h2",null,"Payment Methods",-1)),s[14]||(s[14]=e("div",{class:"payment-intro-text"},[e("p",null," Manage your saved card details and billing history through our secure payment partner. ")],-1)),e("div",{class:"payment-method-row"},[s[12]||(s[12]=e("div",{class:"payment-info"},[e("h4",null,"Card Details"),e("p",null,"Add or remove credit and debit cards securely.")],-1)),e("button",{onClick:A,class:"btn btn-secondary"}," Manage on Paystack ")])]),e("div",Q,[s[18]||(s[18]=e("h2",null,"Preferences",-1)),e("div",Z,[s[16]||(s[16]=e("label",{for:"currency-select"},"Preferred Currency",-1)),l(e("select",{"onUpdate:modelValue":s[3]||(s[3]=o=>g.currency=o)},s[15]||(s[15]=[e("option",{value:"NGN"},"NGN",-1),e("option",{value:"USD"},"USD",-1)]),512),[[M,g.currency]]),s[17]||(s[17]=e("small",null,"This will update prices across the site.",-1))])]),e("div",_,[s[20]||(s[20]=e("h2",null,"Danger Zone",-1)),e("div",H,[s[19]||(s[19]=e("div",{class:"danger-info"},[e("h4",null,"Delete Your Account"),e("p",null," This action is irreversible. All your course progress and data will be permanently lost. ")],-1)),e("button",{onClick:s[4]||(s[4]=o=>i.value=!0),class:"btn btn-danger"}," Delete Account ")])]),i.value?(d(),a("div",K,[e("div",W,[s[23]||(s[23]=e("h2",null,"Confirm Account Deletion",-1)),s[24]||(s[24]=e("p",null,[U(" This action is permanent. To proceed, please type "),e("strong",null,"DELETE"),U(" in the box below. ")],-1)),e("div",X,[s[21]||(s[21]=e("label",{for:"delete-confirm-input"},"Confirmation",-1)),l(e("input",{type:"text","onUpdate:modelValue":s[5]||(s[5]=o=>v.value=o),placeholder:"Type DELETE here"},null,512),[[u,v.value]])]),b.value?(d(),a("p",ee," For your security, please provide your current password. ")):w("",!0),b.value?(d(),a("div",se,[s[22]||(s[22]=e("label",{for:"reauth-password"},"Current Password",-1)),l(e("input",{type:"password","onUpdate:modelValue":s[6]||(s[6]=o=>m.value=o)},null,512),[[u,m.value]])])):w("",!0),e("div",te,[e("button",{onClick:s[7]||(s[7]=o=>i.value=!1),class:"btn btn-secondary"}," Cancel "),e("button",{onClick:E,class:"btn btn-danger",disabled:!N.value},C(c.value?"Deleting...":"Confirm Deletion"),9,oe)])])])):w("",!0)]))}},le=S(re,[["__scopeId","data-v-a9d19032"]]);export{le as default};
